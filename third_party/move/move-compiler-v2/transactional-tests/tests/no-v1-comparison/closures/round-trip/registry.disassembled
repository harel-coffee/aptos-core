//**** Cross-compiled for `masm` syntax from `tests/no-v1-comparison/closures/registry.move`

//# publish
// Bytecode version v8
module 0x66::registry
use 0x1::signer
struct R<T0> has key
  _0: T0

// Function definition at index 0
#[persistent] public fun remove<T0: store>(l0: &signer): T0 acquires R
    move_loc l0
    call signer::address_of
    move_from R<T0>
    unpack R<T0>
    ret

// Function definition at index 1
#[persistent] public fun store<T0: store>(l0: &signer, l1: T0)
    move_loc l0
    move_loc l1
    pack R<T0>
    move_to R<T0>
    ret



//# publish
// Bytecode version v8
module 0x66::delayed_work
use 0x66::registry
struct Work has store
  _0: |u64|u64 has store

// Function definition at index 0
entry fun add(l0: &signer, l1: u64)
    local l2: Work
    copy_loc l0
    call registry::remove<Work>
    move_loc l1
    pack_closure more_work, 11
    pack Work
    // @5
    st_loc l2
    move_loc l0
    move_loc l2
    call registry::store<Work>
    ret

// Function definition at index 1
entry fun eval(l0: &signer, l1: u64, l2: u64)
    local l3: |u64|u64 has store
    move_loc l0
    call registry::remove<Work>
    unpack Work
    st_loc l3
    move_loc l1
    // @5
    move_loc l3
    call_closure <|u64|u64 has store>
    move_loc l2
    eq
    br_false l0
    // @10
    ret
l0: ld_u64 14566554180833181696
    abort

// Function definition at index 2
#[persistent] public fun id_fun(l0: u64): u64
    move_loc l0
    ret

// Function definition at index 3
entry fun initialize(l0: &signer)
    move_loc l0
    pack_closure id_fun, 0
    pack Work
    call registry::store<Work>
    ret

// Function definition at index 4
#[persistent] public fun more_work(l0: Work, l1: u64, l2: u64): u64
    local l3: |u64|u64 has store
    move_loc l0
    unpack Work
    st_loc l3
    move_loc l1
    move_loc l3
    // @5
    call_closure <|u64|u64 has store>
    move_loc l2
    add
    ret



//# run 0x66::delayed_work::initialize --signers 0x66

//# run 0x66::delayed_work::add --signers 0x66 --args 5

//# run 0x66::delayed_work::add --signers 0x66 --args 7

//# run 0x66::delayed_work::eval --signers 0x66 --args 3 15